<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Color Catcher</title>
  <style>
body {
  margin: 0;
  overflow: hidden;
  background-color: #2c3e50;
  font-family: sans-serif;
  color: white;
  text-align: center;
}

canvas {
  display: block;
}

#scoreboard {
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 24px;
}

#targetColorDisplay {
  position: absolute;
  top: 50px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 20px;
}

#colorBox {
  display: inline-block;
  width: 30px;
  height: 30px;
  margin-left: 10px;
  vertical-align: middle;
  border: 2px solid white;
}

#restartButton {
  position: absolute;
  top: 90px;
  left: 50%;
  transform: translateX(-50%);
  padding: 8px 20px;
  font-size: 18px;
  cursor: pointer;
  border: none;
  border-radius: 5px;
  background-color: #3498db;
  color: white;
  transition: background-color 0.3s ease;
}

#restartButton:hover {
  background-color: #2980b9;
}
  </style>
</head>
<body>
  <div id="scoreboard">Score: 0 | Time: 90</div>
  <div id="targetColorDisplay">Catch color: <div id="colorBox"></div></div>
  <button id="restartButton">Restart</button>
  <canvas id="gameCanvas"></canvas>
  <script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let score = 0;
let timeLeft = 90;
const scoreboard = document.getElementById("scoreboard");
const colorBox = document.getElementById("colorBox");

const colors = ["red", "green", "blue", "yellow", "magenta", "cyan"];
let targetColor = colors[Math.floor(Math.random() * colors.length)];
colorBox.style.backgroundColor = targetColor;

const catcher = {
  x: canvas.width / 2 - 50,
  y: canvas.height - 50,
  width: 100,
  height: 20,
  moveTo(x) {
    this.x = Math.min(canvas.width - this.width, Math.max(0, x - this.width / 2));
  },
  draw() {
    ctx.fillStyle = "white";
    ctx.fillRect(this.x, this.y, this.width, this.height);
  },
};

const balls = [];
let ballSpeed = 3;
let spawnRate = 1000;

function spawnBall() {
  // İstenen renkte topun çıkma olasılığını arttırmak için
  let randomNum = Math.random();
  let color;
  if (randomNum < 0.5) {
    color = targetColor;
  } else {
    // Rastgele diğer renklerden seç
    let otherColors = colors.filter(c => c !== targetColor);
    color = otherColors[Math.floor(Math.random() * otherColors.length)];
  }

  balls.push({
    x: Math.random() * (canvas.width - 20),
    y: -20,
    radius: 20,
    speed: ballSpeed,
    color,
  });
}

function updateBalls() {
  for (let i = balls.length - 1; i >= 0; i--) {
    const ball = balls[i];
    ball.y += ball.speed;


    if (
      ball.y + ball.radius >= catcher.y &&
      ball.x >= catcher.x &&
      ball.x <= catcher.x + catcher.width
    ) {
      if (ball.color === targetColor) {
        score += 10;
      } else {
        score = Math.max(0, score - 5);
      }
      balls.splice(i, 1);
      continue;
    }


    if (ball.y - ball.radius > canvas.height) {
      balls.splice(i, 1);
    }
  }
}

function drawBalls() {
  balls.forEach(ball => {
    ctx.beginPath();
    ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
    ctx.fillStyle = ball.color;
    ctx.fill();
    ctx.closePath();
  });
}

function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  catcher.draw();
  updateBalls();
  drawBalls();
  scoreboard.innerText = `Score: ${score} | Time: ${timeLeft}`;
}

canvas.addEventListener("mousemove", e => catcher.moveTo(e.clientX));
canvas.addEventListener("touchmove", e => {
  const touch = e.touches[0];
  catcher.moveTo(touch.clientX);
});

let gameInterval = setInterval(() => {
  update();
}, 1000 / 90);

let ballInterval = setInterval(spawnBall, spawnRate);

let timerInterval = setInterval(() => {
  timeLeft--;
  if (timeLeft <= 0) {
    clearInterval(gameInterval);
    clearInterval(ballInterval);
    clearInterval(timerInterval);

    alert(`Game over! Your score: ${score}`);
  }

  if (timeLeft % 10 === 0 && timeLeft !== 90) {
    ballSpeed += 0.5;
    if (spawnRate > 300) {
      clearInterval(ballInterval);
      spawnRate -= 100;
      ballInterval = setInterval(spawnBall, spawnRate);
    }
  }

  if ((90 - timeLeft) % 8 === 0) {
    let newColor;
    do {
      newColor = colors[Math.floor(Math.random() * colors.length)];
    } while (newColor === targetColor);
    targetColor = newColor;
    colorBox.style.backgroundColor = targetColor;
  }
}, 1000);


// Yeniden başlatma butonu için fonksiyon
function restartGame() {
  score = 0;
  timeLeft = 90;
  ballSpeed = 3;
  spawnRate = 1000;
  balls.length = 0;

  clearInterval(gameInterval);
  clearInterval(ballInterval);
  clearInterval(timerInterval);

  gameInterval = setInterval(() => {
    update();
  }, 1000 / 90);

  ballInterval = setInterval(spawnBall, spawnRate);

  timerInterval = setInterval(() => {
    timeLeft--;
    if (timeLeft <= 0) {
      clearInterval(gameInterval);
      clearInterval(ballInterval);
      clearInterval(timerInterval);

      alert(`Game over! Your score: ${score}`);
    }

    if (timeLeft % 10 === 0 && timeLeft !== 90) {
      ballSpeed += 0.5;
      if (spawnRate > 300) {
        clearInterval(ballInterval);
        spawnRate -= 100;
        ballInterval = setInterval(spawnBall, spawnRate);
      }
    }

    if ((90 - timeLeft) % 8 === 0) {
      let newColor;
      do {
        newColor = colors[Math.floor(Math.random() * colors.length)];
      } while (newColor === targetColor);
      targetColor = newColor;
      colorBox.style.backgroundColor = targetColor;
    }
  }, 1000);
}
document.getElementById("restartButton").addEventListener("click", restartGame);

  </script>
</body>
</html>